{% extends 'base.html' %}
{% block content %}
<h1>WAN Configuration</h1>
<form method="post" action="{{ url_for('wan.index') }}">
  <div class="mb-3">
    <label for="iface-select" class="form-label">Select WAN Interface</label>
    <select id="iface-select" name="iface" class="form-select" required>
      <option value="" disabled {% if not current_iface %}selected{% endif %}>-- Select interface --</option>
      {% for iface in interfaces %}
        <option value="{{ iface }}" {% if iface == current_iface %}selected{% endif %}>{{ iface }}</option>
      {% endfor %}
    </select>
  </div>
  <div class="mb-3">
    <label for="mode-select" class="form-label">Configuration Mode</label>
    <select id="mode-select" name="mode" class="form-select" required>
      <option value="dhcp" {% if mode=='dhcp' %}selected{% endif %}>DHCP (dynamic)</option>
      <option value="static" {% if mode=='static' %}selected{% endif %}>Static</option>
    </select>
  </div>
  <div id="static-fields" {% if mode!='static' %}style="display:none"{% endif %}>
    <div class="mb-3">
      <label for="address" class="form-label">IP Address</label>
      <input type="text" class="form-control" id="address" name="address"
             value="{{ static_cfg.get('address','') }}">
    </div>
    <div class="mb-3">
      <label for="netmask" class="form-label">Netmask</label>
      <input type="text" class="form-control" id="netmask" name="netmask"
             value="{{ static_cfg.get('netmask','') }}">
    </div>
    <div class="mb-3">
      <label for="gateway" class="form-label">Gateway</label>
      <input type="text" class="form-control" id="gateway" name="gateway"
             value="{{ static_cfg.get('gateway','') }}">
    </div>
    <div class="mb-3">
      <label for="dns" class="form-label">DNS Nameservers (space-separated)</label>
      <input type="text" class="form-control" id="dns" name="dns"
             value="{{ static_cfg.get('dns-nameservers','') }}">
    </div>
    <div class="mb-3">
      <label for="broadcast" class="form-label">Broadcast</label>
      <input type="text" class="form-control" id="broadcast" name="broadcast"
             value="{{ static_cfg.get('broadcast','') }}">
    </div>
  </div>
  <button type="submit" class="btn btn-primary">Save WAN Configuration</button>
</form>
{% block scripts %}
<script>
  function toggleStatic() {
    var mode = document.getElementById('mode-select').value;
    var sf = document.getElementById('static-fields');
    sf.style.display = (mode === 'static') ? 'block' : 'none';
  }
  document.getElementById('mode-select').addEventListener('change', toggleStatic);
  document.addEventListener('DOMContentLoaded', toggleStatic);
</script>
{% endblock %}
{% endblock %}
