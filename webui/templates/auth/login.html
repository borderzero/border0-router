{% extends 'auth_base.html' %}
{% block content %}
<div class="row justify-content-center" style="margin-top: 100px;">
  <div class="col-md-4">
    <div class="card">
      <div class="card-body">
        <h4 class="card-title mb-4">Login to Border0 Org</h4>
        {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
            {% for category, message in messages %}
              <div class="alert alert-{{ category }}">{{ message }}</div>
            {% endfor %}
          {% endif %}
        {% endwith %}
        {% if not login_url %}
        <form method="post">
          <div class="mb-3">
            <label for="org" class="form-label">Organization</label>
            <input type="text" id="org" name="org" class="form-control" placeholder="Enter your org subdomain" value="{{ org or '' }}" required>
          </div>
          <button type="submit" class="btn btn-primary w-100">Login to Border0</button>
        </form>
        {% endif %}
        {% if login_url %}
        <script>window.open('{{ login_url }}', '_blank');</script>
        <p class="mt-3">If the login page did not open automatically, <a href="{{ login_url }}" target="_blank">click here</a> to proceed.</p>
        {% endif %}
        {% if user_info %}
        <div class="mt-4 text-center">
          <img src="{{ user_info.picture }}" alt="{{ user_info.name }}" height="64" class="rounded-circle mb-2">
          <h5>{{ user_info.name }} <small class="text-muted">({{ user_info.nickname }})</small></h5>
          <p class="mb-1"><strong>Email:</strong> {{ user_info.user_email }}</p>
          <p class="mb-1"><strong>Org ID:</strong> {{ user_info.org_id }}</p>
          <form method="post">
            <button type="submit" class="btn btn-success w-100 mt-3">Continue as {{ user_info.name }}</button>
          </form>
        </div>
        {% endif %}
      </div>
    </div>
  </div>
</div>
{% endblock %}
